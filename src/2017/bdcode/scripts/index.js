Array.prototype.map||(Array.prototype.map=function(t,e){var r,o,n;if(null==this)throw new TypeError(" this is null or not defined");var i=Object(this),s=i.length>>>0;if("[object Function]"!=Object.prototype.toString.call(t))throw new TypeError(t+" is not a function");for(e&&(r=e),o=new Array(s),n=0;n<s;){var a,u;n in i&&(a=i[n],u=t.call(r,a,n,i),o[n]=u),n++}return o}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var r,o;if(null===this)throw new TypeError(" this is null or not defined");var n=Object(this),i=n.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(arguments.length>1&&(r=e),o=0;o<i;){var s;o in n&&(s=n[o],t.call(r,s,o,n)),o++}}),"function"!=typeof Object.create&&(Object.create=function(){function t(){}var e=Object.prototype.hasOwnProperty;return function(r){if("object"!=typeof r)throw TypeError("Object prototype may only be an Object or null");t.prototype=r;var o=new t;if(t.prototype=null,arguments.length>1){var n=Object(arguments[1]);for(var i in n)e.call(n,i)&&(o[i]=n[i])}return o}}()),function(t,e){"function"==typeof define&&define.amd?define("PubSub",[],function(){return e(t)}):"object"==typeof module&&module.exports?module.exports=e(t):t.PubSub=e(t)}(this,function(t){function e(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}function r(t,r,o){if(e(t))if("function"==typeof t.forEach)t.forEach(r,o);else for(var n=0,i=t.length;n<i;n++)r.call(o,t[n],n,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&r.call(o,t[s],s,t)}function o(t){return new RegExp("^"+t.replace(".","\\.")+"(\\.|$)")}function n(){this._messagePool={}}var i=n.prototype;return i.on=function(t,e,r){var o=this._messagePool[t]||(this._messagePool[t]=[]);return o.push({callback:e,context:r||this}),this},i.once=function(t,e,r){var o=this,n=function(){o.off(t,n),e.apply(this,arguments)};return this.on(t,n,r)},i.off=function(t,e){var n,i;return"string"==typeof t?(n=t,i=e):"function"==typeof t&&(i=t),n||i?r(this._messagePool,function(t,e){var s=n?o(n):new RegExp;n&&!i?s.test(e)&&delete this._messagePool[e]:r(t,function(r,o){n&&i&&s.test(e)&&r.callback===i?t.splice(o,1):!n&&i&&r.callback===i&&t.splice(o,1)},this)},this):this._messagePool={},this},i.trigger=function(t,e){"undefined"!=typeof t&&(e=Array.prototype.slice.call(arguments,1),r(this._messagePool,function(n,i){o(t).test(i)&&r(n,function(t,r){t.callback.apply(t.context,e)},this)},this))},n.mixTo=function(t){var e=t;return"[object Function]"===Object.prototype.toString.call(t)&&(e=t.prototype),e._messagePool={},r(n.prototype,function(t,r){e[r]=t}),t},n}),function(t,e){"function"==typeof define&&define.amd?define("Loader",["pubsub"],function(r){return e(t,r)}):"object"==typeof module&&module.exports?module.exports=e(t,require("PubSub")):t.Loader=e(t,t.PubSub)}(this,function(t,e){function r(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}function o(t,e,o){if(r(t))if("function"==typeof t.forEach)t.forEach(e,o);else for(var n=0,i=t.length;n<i;n++)e.call(o,t[n],n,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(o,t[s],s,t)}function n(t){return a.IMAGE.test(t)?s.IMAGE:a.JSON.test(t)?s.JSON:null}function i(t){this.baseUrl=t||"",this.resources={},this.groups={},e.call(this)}var s={IMAGE:"image",JSON:"json"},a={IMAGE:/\.(jpg|png|gif)$/,JSON:/\.(json)$/},u={loadAsset:function(t,e,r){var o={};switch("string"==typeof t?(o.url=t,"string"==typeof e?(o.type=e,e=r,r=arguments[3]):o.type=n(t)):(t.type="string"==typeof t.type?t.type:n(t.type),o=t),o.type){case s.IMAGE:this.loadImage(o,e,r);break;case s.JSON:this.loadJson(o,e,r);break;default:console.log("type not support"),r&&r(o)}},ajax:function(t){var e=new XMLHttpRequest;e.onreadystatechange=function(){try{e.readyState===XMLHttpRequest.DONE&&(200===e.status?t.success&&t.success(e.responseText):t.error&&t.error())}catch(r){t.error&&t.error()}},e.open("GET",t.url),e.send()},loadJson:function(t,e,r){this.ajax({url:t.url,success:function(r){t.data=JSON.parse(r),e&&e(t)},error:function(){r&&r(t)}})},loadImage:function(t,e,r){var o=new Image;o.onload=function(){o.onload=new Function,t.data=o,e&&e(t)},o.onerror=function(){o.onerror=new Function,console.log("load fail"),r&&r(t)},o.src=t.url}};return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype.add=function(t,e,o,i){if(!t||!e)throw new Error("No url passed to add loader to loader.");return"string"!=typeof o&&(i=o,o=void 0),r(e)?this.addGroup(t,e,i):(this.resources[t]={url:/^http:/.test(e)?e:this.baseUrl+e,type:"string"==typeof o?o:n(e),name:t},this)},i.prototype.addGroup=function(t,e,r){if(!t||!e)throw new Error("No url passed to add loader to loader.");return this.groups[t]=e.map(function(t){return t.url=/^http:/.test(t.url)?t.url:this.baseUrl+t.url,t.type="string"==typeof t.type?t.type:n(t.url),this.resources[t.name]=t,t.name},this),this},i.prototype.load=function(t,e){if(!(t in this.resources))return this.loadGroup(t,e);var r=this,o=this.resources[t];return u.loadAsset(o,function(){r.trigger("complete",t)}),this},i.prototype.loadGroup=function(t,e){if(!(t in this.groups))return console.log("data not exit"),this;var r=this.groups[t],o=r.length,n=0,i=this,s=this.resources[r[n]];return o===n?(this.trigger("complete",t,o),this):(u.loadAsset(s,function(e){n++,i.trigger("progress",t,n,o),n==o?i.trigger("complete",t,o):(s=i.resources[r[n]],u.loadAsset(s,arguments.callee))}),this)},i.prototype.get=function(t){return this.resources[t]?this.resources[t]:this.groups[t]?this.getGroup(t):null},i.prototype.getGroup=function(t){if(this.groups[t]){var e=this;return this.groups[t].map(function(t){return e.resources[t]})}return null},i.prototype.getAll=function(){return this.resources},i.load=function(t,e){return r(t)?i.loadGroup(t,e):(u.loadAsset(t,e),i)},i.loadGroup=function(t,e){var r=t.length,n=0;return o(t,function(t,o){u.loadAsset("string"==typeof t?t:t.url,t.type,function(){n++,e(n,r)})}),i},i});var resData=[{name:"cake_png",type:"image",url:"http://edm.mcake.com/weifengwang/bdcode/images/cake.png"},{name:"cake2_png",type:"image",url:"http://edm.mcake.com/weifengwang/bdcode/images/cake2.png"},{name:"code_png",type:"image",url:"http://edm.mcake.com/weifengwang/bdcode/images/code.png"},{name:"step1_png",type:"image",url:"http://edm.mcake.com/weifengwang/bdcode/images/step1.png"},{name:"step2_png",type:"image",url:"http://edm.mcake.com/weifengwang/bdcode/images/step2.png"},{name:"title_png",type:"image",url:"http://edm.mcake.com/weifengwang/bdcode/images/title.png"}];!function(){function t(t){for(var e=document.getElementsByTagName("img"),r=0,o=e.length;r<o;r++){var n=e[r],i=n.getAttribute("src-fix"),s=t[i];i&&s&&n.setAttribute("src",s.url)}}function e(){var e=new Loader("images/"),o=document.getElementById("evt_spin"),n=document.getElementById("evt_loading");e.addGroup("preload",resData),e.on("progress",function(t,e,r){o.innerHTML=parseInt(e/r*100)+"%"}),e.on("complete",function(o){t(e.getAll()),n.style.display="none",document.getElementById("evt_container").style.display="block",r($("#evt_container").get(0))}),e.loadGroup("preload")}var r=function(t){var e=navigator.appVersion.split("MSIE"),r=parseFloat(e[1]);if(r&&r>=5.5&&r<9&&document.body.filters)for(var o=0,n=t.getElementsByTagName("img"),i=0;i<n.length;i++){var s=n[i],a=s.src.toUpperCase();if("PNG"==a.substring(a.length-3,a.length)&&!s.getAttribute("usemap")){o++;var u=s.id||"ra_png_"+o.toString(),c=new Image;c.proData=u,c.onload=function(){$("#"+this.proData).css("width",this.width+"px").css("height",this.height+"px")},c.src=s.src;var l="id='"+u+"' ",p=s.className?"class='"+s.className+"' ":"",f=s.title?"title='"+s.title+"' ":"title='"+s.alt+"' ",g="display:inline-block;"+s.style.cssText;"left"==s.align&&(g="float:left;"+g),"right"==s.align&&(g="float:right;"+g),s.parentElement.href&&(g="cursor:hand;"+g);var h="<span "+l+p+f+' style="width:'+s.width+"px; height:"+s.height+"px;"+g+";filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+s.src+"', sizingMethod='scale');\"></span>";s.outerHTML=h,i-=1}}};e()}();